title: API
----

# TwinSpark API {.text-center}

## HTML updates

<table class="table">
<tr><th>Directive</th> <th>Description</th></tr>

<tr><th colspan=2 class="text-center">Core</th></tr>

<tr><td><a href="ts-req/">ts-req</a></td>                    <td>Make a request for an HTML</td></tr>
<tr><td><a href="ts-target/">ts-target</a></td>              <td>Replace another part of a page with incoming HTML</td></tr>
<tr><td><a href="ts-req-selector/">ts-req-selector</a></td>  <td>Select only a part of a response</td></tr>
<tr><td><a href="ts-swap/">ts-swap</a></td>                  <td>Select a strategy for HTML replacement</td></tr>
<tr><td><a href="ts-swap-push/">ts-swap-push</a></td>        <td>"Push" HTML from server to a client</td></tr>
<tr><td><a href="ts-trigger/">ts-trigger</a></td>            <td>Specify event which triggers the request</td></tr>

<tr><th colspan=2 class="text-center">Additional</th></tr>

<tr><td><a href="ts-req-method/">ts-req-method</a></td>      <td>Is it GET or POST?</td></tr>
<tr><td><a href="ts-req-strategy/">ts-req-strategy</a></td>  <td>How to deal with multiple requests being generated</td></tr>
<tr><td><a href="ts-req-history/">ts-req-history</a></td>    <td>Change URL after request</td></tr>
<tr><td><a href="ts-data/">ts-data</a></td>                  <td>Additional data for request</td></tr>
<tr><td><a href="ts-json/">ts-json</a></td>                  <td>As <code>ts-data</code>, but for JSON requests</td></tr>
<tr><td><a href="ts-req-batch/">ts-req-batch</a></td>        <td>Combine multiple requests into a single one</td></tr>

</table>

## Actions

<table class="table">
<tr><th>Directive</th> <th>Description</th></tr>

<tr><td><a href="ts-action/">ts-action</a></td>         <td>Run actions</td></tr>
<tr><td><a href="ts-trigger/">ts-trigger</a></td>       <td>Specify event which triggers actions</td></tr>
<tr><td><a href="ts-req-before/">ts-req-before</a></td> <td>Actions to run before request</td></tr>
<tr><td><a href="ts-req-after/">ts-req-after</a></td>   <td>Actions to run after request</td></tr>

</table>


## Events

<table class="table">
<tr><th>Event</th> <th>Description</th></tr>

<tr><td><code>ts-ready</code></td>        <td>When HTML is "activated"</td></tr>
<tr><td><code>ts-trigger</code></td>      <td>Event generated by <code>ts-trigger</code></td></tr>
<tr><td><code>ts-req-before</code></td>   <td>Before request</td></tr>
<tr><td><code>ts-req-after</code></td>    <td>After request</td></tr>
<tr><td><code>ts-req-error</code></td>    <td>On request errors</td></tr>
<tr><td><code>ts-pushstate</code></td>    <td>When a new entry is pushed to browser history</td></tr>
<tr><td><code>ts-replacestate</code></td> <td>When a browser history entry is replaced</td></tr>
<tr><td><code>visible</code></td>         <td>When 1% of element appears on screen</td></tr>
<tr><td><code>invisible</code></td>       <td>When element was visible and now less than 1% of it is</td></tr>
<tr><td><code>closeby</code></td>         <td>When 1% of element is closer to viewport than half of window height</td></tr>
<tr><td><code>away</code></td>            <td>Anthonym to <code>closeby</code></td></tr>
<tr><td><code>remove</code></td>          <td>When an element is removed (depends on a trigger subscribing)</td></tr>
<tr><td><code>empty</code></td>           <td>When element becomes childless</td></tr>
<tr><td><code>notempty</code></td>        <td>When element had hierarchy changes and has children</td></tr>
<tr><td><code>childrenChange</code></td>  <td>Combination of <code>empty</code> and <code>notempty</code></td></tr>

</table>


## Headers

<table class="table">
<tr><th>Header</th> <th>Description</th></tr>

<tr><th colspan=2 class="text-center">Request</th></tr>

<tr><td><code>accept</code></td> <td>TwinSpark requests are always <code>text/html+partial</code></td></tr>
<tr><td><code>ts-url</code></td> <td>Current page URL</td></tr>
<tr><td><code>ts-origin</code></td> <td>Identifier of an element which made request</td></tr>
<tr><td><code>ts-target</code></td> <td>Identifier of a target element</td></tr>

<tr><th colspan=2 class="text-center">Response</th></tr>
<tr><td><code>ts-swap</code></td>      <td>Override HTML swap strategy</td></tr>
<tr><td><code>ts-swap-push</code></td> <td>"Push" some HTML, <code>replace: selector to <= selector from</code></td></tr>
<tr><td><code>ts-history</code></td>   <td>New browser history URL</td></tr>
<tr><td><code>ts-title</code></td>     <td>New page title in case of history push</td></tr>
<tr><td><code>ts-location</code></td>     <td>Redirect to target URL</td></tr>

</table>


## Config

Configuration attributes can be can set on twinspark <code>script</code> tag:

```
<script src="/static/twinspark.js" data-timeout="5000">
```

<table class="table">
<tr><th>Attribute</th> <th>Default</th> <th>Description</th></tr>

<tr><td><code>data-timeout</code></td>      <td>3000</td>      <td>Timeout for <code>ts-req</code> requests</td></tr>
<tr><td><code>data-history</code></td>      <td>20</td>        <td>Limit for IndexedDB page history storage (set to 0 to disable)</td></tr>
<tr><td><code>data-settle</code></td>       <td>class,style,width,height</td>   <td>Attributes to settle during non-morph swap</td></tr>
<tr><td><code>data-active-class</code></td> <td>ts-active</td> <td>Class for an element which made a request, until it ends</td></tr>
<tr><td><code>data-insert-class</code></td> <td>ts-insert</td> <td>Class for a newly inserted elements with an id</td></tr>
<tr><td><code>data-remove-class</code></td> <td>ts-remove</td> <td>Class for an element with an id being removed from DOM</td></tr>

</table>


## JavaScript API

<i>To be done</i>
